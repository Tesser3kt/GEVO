\subsubsection{Podgrafy, souvislost a metrika}
\label{sssec:podgrafy-souvislost-a-metrika}

V této relativně krátké podsekci dáme formální tvář představě, že
\begin{enumerate}
 \item nějaký graf je \uv{uvnitř} druhého;
 \item graf je souvislý a rozpadá se na tzv. \emph{komponenty souvislosti}, tedy
  maximální souvislé části;
 \item graf je \emph{metrický} prostor, tedy prostor, ve kterém lze měřit
  vzdálenosti.
\end{enumerate}

Začneme bodem (1), vedoucím na pojem \emph{podgrafu}. Jeho definice je opravdu
nejjednodušší možná, požadujeme pouze, aby vrcholy a hrany podgrafu tvořili
podmnožinu vrcholů a hran většího grafu.

\begin{definition}[Podgraf]
 \label{def:podgraf}
 Ať $G = (V,E)$ je graf. Řekneme, že graf $H = (V',E')$ je \emph{podgrafem} $G$,
 pokud
 \[
  V' \subseteq V \quad \text{a} \quad E' \subseteq E.
 \]
\end{definition}

\begin{remark}
 Žádáme čtenáře, aby sobě povšimli, že podgraf \textbf{nemusí zachovat} hranovou
 strukturu svého nadgrafu. Přesněji, \hyperref[def:podgraf]{definice podgrafu}
 neobsahuje podmínku, že mezi vrcholy $H$ musí vést hrana, pokud mezi těmi
 samými vrcholy v $G$ hrana vedla.

 Taková definice je z pohledu algebraika zhola zbytečná, bať odpudivá. Hranová
 struktura je zásadní součástí definice grafu a měla by být dodržena. Z tohoto
 důvodu se nehodí říkat, že by podgraf byl \emph{podstrukturou} svého nadgrafu,
 kterakžekolivěk vágně je ono slovo vyloženo.
\end{remark}

Předchozí poznámka motivuje definici \emph{indukovaného podgrafu}, podgrafu,
jemuž je přikázáno původní strukturu zachovat. Žargonový výraz \uv{indu\-kovaný}
v~tomto kontextu obyčejně znamená přibližně \uv{plynoucí z}. Čili, indukovaný
podgraf je podgraf, jehož struktura \textbf{plyne ze} struktury vyššího grafu.

Tuto podmínku lze formulovat snadno. Díváme-li se na hrany jako na podmnožiny
systému dvouprvkových podmnožin $V$, tedy jako na množinu $E \subseteq
\binom{V}{2}$, pak požadavek, aby nějaký podgraf $H = (V',E')$ grafu $G = (V,E)$
obsahoval spolu s každou dvojicí vrcholů i hranu mezi nimi, pokud je v~$E$, lze
vyjádřit zkrátka tak, že nařídíme, aby $E' = E \cap \binom{V'}{2}$, tedy aby
$E'$ byla vlastně množina $E$, ve které necháme jen ty hrany, které vedou mezi
vrcholy z $V'$.

\begin{definition}[Indukovaný podgraf]
 \label{def:indukovany-podgraf}
 Ať $G = (V,E)$ je graf a $H = (V',E')$ jeho podgraf. Řekneme, že $H$ je
 \emph{indukovaný} (grafem $G$), pokud \textbf{zachovává hranovou strukturu na
 $G$}, to jest,
 \[
  E' = E \cap \binom{V'}{2}.
 \]
\end{definition}

\begin{remark}
 Je dlužno nahlédnout, že indukovaný podgraf grafu $G = (V,E)$ je jednoznačně
 určen svoji množinou vrcholů. Totiž, vyberu-li z $V$ podmnožinu $V'$, pak mezi
 všemi vrcholy z $V'$ musejí v indukovaném podgrafu vést všechny hrany, které
 mezi nimi vedou i v původním grafu. Množina $E'$ je tudíž kompletně popsána
 množinami $V'$ a $E$.
\end{remark}

\begin{figure}[h]
 \centering
 \begin{subfigure}{.47\textwidth}
  \centering
  \begin{tikzpicture}
   \node[vertex] (v1) at (30:2) {};
   \node[vertex,myred,minimum size=11pt] (v2) at (90:2) {};
   \node[vertex,myred,minimum size=11pt] (v3) at (150:2) {};
   \node[vertex,myred,minimum size=11pt] (v4) at (210:2) {};
   \node[vertex,myred,minimum size=11pt] (v5) at (270:2) {};
   \node[vertex] (v6) at (330:2) {};

   \draw[thick] (v1) -- (v2);
   \draw[thick] (v2) -- (v3);
   \draw[ultra thick,myred] (v3) -- (v4);
   \draw[thick] (v4) -- (v5);
   \draw[thick] (v5) -- (v6);
   \draw[thick] (v6) -- (v1);
   
   \draw[thick] (v1) -- (v4);
   \draw[thick] (v3) -- (v6);
   \draw[ultra thick,myred] (v2) -- (v5);
  \end{tikzpicture}
  \caption{\clr{Podgraf}, který není indukovaný.}
  \label{subfig:neindukovany-podgraf}
 \end{subfigure}
 \begin{subfigure}{.47\textwidth}
  \centering
  \begin{tikzpicture}
   \node[vertex,myred,minimum size=11pt] (v1) at (30:2) {};
   \node[vertex] (v2) at (90:2) {};
   \node[vertex,myred,minimum size=11pt] (v3) at (150:2) {};
   \node[vertex,myred,minimum size=11pt] (v4) at (210:2) {};
   \node[vertex] (v5) at (270:2) {};
   \node[vertex,myred,minimum size=11pt] (v6) at (330:2) {};
   
   \draw[thick] (v1) -- (v2);
   \draw[thick] (v2) -- (v3);
   \draw[ultra thick,myred] (v3) -- (v4);
   \draw[thick] (v4) -- (v5);
   \draw[thick] (v5) -- (v6);
   \draw[ultra thick,myred] (v6) -- (v1);
   
   \draw[ultra thick,myred] (v1) -- (v4);
   \draw[thick] (v2) -- (v5);
   \draw[ultra thick,myred] (v3) -- (v6);
  \end{tikzpicture}
  \caption{\clr{Indukovaný} podgraf.}
  \label{subfig:indukovany-podgraf}
 \end{subfigure}
 \caption{Rozdíl mezi podgrafem a \emph{indukovaným} podgrafem.}
 \label{fig:indukovany-podgraf}
\end{figure}

Každý graf se přirozeně rozkládá na své maximální souvislé indukované podgrafy,
tzv. \emph{komponenty souvislosti}. Toto slovo jsme zde zmínili mnohokrát v
různých kontextech, však vždy bez řádné definice. Důvodem je fakt, že samotná
definice komponent souvislosti není zcela bez práce.

Nabízejí se dva přirozené přístupy, jejichž ekvivalenci si postupně ukážeme.
První, snad více informatický přístup, je definovat komponentu souvislosti jako
\textbf{maximální souvislý podgraf}, tedy takový (indukovaný) podgraf, mezi
každým párem jehož vrcholů vede cesta a je největší takový; to jest, k žádnému z
ostatních vrcholů vyššího grafu z vrcholů tohoto podgrafu cesta nevede. Tento
postup jsme nazvali \emph{informatickým}, neb popisuje, jak se algoritmicky
komponenty souvislosti v grafu hledají. Zkrátka tak, že začneme v libovolném
vrcholu, pokračujeme z něj do jeho sousedů a pak zase do jejich sousedů tak
dlouho, dokud to lze. V moment, kdy už se nikam dál z původního vrcholu nemůžeme
dostat, našli jsme tu \textbf{jednu} komponentu souvislosti, která obsahuje
počáteční vrchol.

Druhý přirozený přístup je ryze matematický a algoritmicky obtížně
realizovatelný. Zase je výhodný pro svou explicitnost a snadné využití v
důkazech. Obvyklý způsob, jak rozdělit množinu (v tomto případě množinu vrcholů,
$V$) na podmnožiny, je užitím \hyperref[def:trida-ekvivalence]{tříd
ekvivalence}. Protože dva vrcholy leží ve stejné komponentě souvislosti právě
tehdy, když mezi nimi vede cesta, nabízí se pro rozkouskování množiny využít
právě relaci \uv{býti cestou mezi vrcholy}. Jediný problém dlí v tom, že není na
první pohled zřejmé, jedná-li se o ekvivalenci.

Definujme na množině vrcholů $V$ grafu $G = (V,E)$ relaci $ \sim $ předpisem
\[
 u \sim v \Leftrightarrow \text{v $G$ vede cesta mezi $u$ a $v$}.
\]
Dokážeme si, že $ \sim $ je ekvivalence.

\begin{lemma}
 \label{lem:cesta-ekvivalence}
 Ať $G = (V,E)$ je graf a $ \sim $ je relace na $V$ dána výše. Pak $ \sim $ je
 ekvivalence na $V$.
\end{lemma}
\begin{proof}
 Dle \hyperref[def:ekvivalence]{definice ekvivalence} potřebujeme ověřit, že $
 \sim $ je
 \begin{enumerate}[label=(\alph*)]
  \item reflexivní, čili $v \sim v \; \forall v \in V$;
  \item symetrická, čili $u \sim v \Rightarrow v \sim u \; \forall u,v \in
   V$;
  \item transitivní, čili $u \sim v \wedge v \sim w \Rightarrow u \sim w$ pro
   všechny $u,v,w \in V$.
 \end{enumerate}
 Body (a) a (b) jsou v zásadě triviální. Pro každé $v \in V$ platí $v \sim v$,
 protože samotný vrchol je z \hyperref[def:cesta]{definice} též cesta. To
 dokazuje (a). Pro důkaz (b) ať $u \sim v$ a $u=v_0v_1\cdots v_n=v$ je cesta z
 $u$ do $v$. Pak $v=v_nv_{n-1}\cdots v_1v_0=u$ je cesta z $v$ do $u$, a tedy
 $v \sim u$.

 Jediný důkaz (c) není samozřejmý. Pro nabytí intuice vizte
 \myref{obrázek}{fig:cesta-transitivni}. Uvědomme si, že \textbf{spojení cest
 není vždy cesta}. Jeho princip spočívá v tom, že máme-li dánu cestu
 $u=u_0u_1\cdots u_n=v$ z $u$ do $v$ a cestu $v=v_0v_1\cdots v_m=w$ z $v$ do
 $w$, pak jdeme po první cestě tak dlouho, dokud nenarazíme na tu druhou. Tu pak
 následujeme až do $w$. Formálně, ať $k \leq n$ je \textbf{nejmenší} takové, že
 $u_k$ leží na cestě mezi $v$ a $w$. Takové $k$ musí existovat, protože zcela
 jistě přinejmenším vrchol $v$ leží jak na cestě z $u$ do $v$, tak na cestě z
 $v$ do $w$. Ať $j \leq m$ je index takový, že $u_k = v_j$. První cestu budeme
 následovat až do $u_k = v_j$ a potom budeme pokračovat po cestě druhé. V
 symbolech, kýžená cesta mezi $u$ a $w$ je v takovém případě
 \[
  (u=u_0)u_1\cdots u_{k-1}(u_k=v_j)v_{j+1}\cdots (v_n=w).
 \]
 Tím je důkaz transitivity $ \sim $ hotov.
\end{proof}

\begin{figure}[h]
 \centering
 \begin{tikzpicture}[scale=1.5]
  \node[vertex,myred] (u) at (0,0) {};
  \node[vertex] (u1) at (0,2) {};
  \node[vertex] (u2) at (1,1) {};
  \node[vertex,mypurple] (v) at (2,1) {};
  \node[vertex,myblue] (w) at (1,3) {};
  \node[vertex] (x) at (2,3) {};

  \draw[thick,myred] (u) -- (u1);
  \draw[thick,myred,transform canvas={yshift=-.75mm},shorten <=-1.5pt,
   shorten >= 1.5pt] (u1) -- (u2);
  \draw[thick,myred,transform canvas={yshift=-.5mm}] (u2) -- (v);
  \draw[thick,myblue,transform canvas={yshift=.5mm}] (u2) -- (v);
  \draw[thick,myblue,transform canvas={yshift=.75mm},shorten <=-1.5pt,
   shorten >= 1.5pt] (u2) -- (u1);
  \draw[thick,myblue] (u1) -- (w);
  \draw[thick] (v) -- (w);
  \draw[thick] (w) -- (x);
  \draw[thick] (v) -- (x);

  \node[left=0mm of u] {$\clr{u_0} = \clr{u}$};
  \node[left=0mm of u1] {\fbox{$\clr{u_1} = \clb{v_2}$}};
  \node[above left=-1mm and -1mm of w] {$\clb{v_3} = \clb{w}$};
  \node[below=0mm of u2] {$\clr{u_2} = \clb{v_1}$};
  \node[below right=-1mm and -1mm of v] {$\clp{v} = \clr{u_3} = \clb{v_0}$};
 \end{tikzpicture}

 \caption{Cesta $\clr{u_0}(\clr{u_1}=\clb{v_2})\clb{v_3}$ mezi $\clr{u}$ a
  $\clb{w}$ sestrojená z cesty $\clr{u_0}\clr{u_1}\clr{u_2}\clr{u_3}$ mezi
  $\clr{u}$ a $\clp{v}$ a z cesty $\clb{v_0}\clb{v_1}\clb{v_2}\clb{v_3}$ mezi
  $\clp{v}$ a $\clb{w}$. Zde $\clr{k} = 1$ a $\clb{j} = 2$.}
 \label{fig:cesta-transitivni}
\end{figure}

Předchozí lemma opravňuje následující definici \emph{komponenty souvislosti}.

\begin{definition}[Komponenta souvislosti]
 \label{def:komponenta-souvislosti}
 Ať $G = (V,E)$ je graf, $ \sim $ je ekvivalence na $V$ z
 \myref{lemmatu}{lem:cesta-ekvivalence} a 
 \[
  V = \bigcup_{i = 1}^{n} V_i
 \]
 je rozklad $V$ na $n \in \N$ tříd ekvivalence $V_i$ podle $ \sim $. Indukované
 podgrafy $G_i = (V_i, E \cap \binom{V_i}{2})$ nazýváme \emph{komponenty
 souvislosti} grafu $G$.
\end{definition}

\begin{remark}
 Připomínáme, že rozklad na třídy ekvivalence
 \[
  V = \bigcup_{i = 1}^{n} V_i
 \]
 znamená, že $V$ má podle $ \sim $ přesně $n$ tříd ekvivalence, pro každé $i
 \leq n$ existuje vrchol $v_i \in V$ takový, že
 \[
  V_i = \{u \in V \mid u \sim v_i\},
 \]
 tedy $V_i$ je množina všech vrcholů, do nichž vede cesta z $v_i$, a $V_i \cap
 V_j = \emptyset$ pro každý pár $i \neq j$, to jest z $v_i$ do $v_j$ nevede
 žádná cesta.
\end{remark}

\begin{observation}
 Komponenty souvislosti $G_i$ grafu $G$ z
 \hyperref[def:komponenta-souvislosti]{definice výše} jsou právě všechny
 maximální souvislé indukované podgrafy grafu $G$.
\end{observation}
\begin{proof}
 Dokazujeme dvě implikace.

 Nejprve ať $G_i$ je nějaká komponenta souvislosti $G$. Podgraf $G_i$ je zřejmě
 indukovaný a souvislý z definice. Pro spor ať existuje vrchol $v \notin V_i$,
 do kterého vede cesta z nějakého vrcholu $u \in V_i$. Spor máme okamžitě, neboť
 $V_i$ z definice obsahuje všechny vrcholy, do nichž vede cesta z $u$. 

 Naopak, ať $H = (V',E')$ je maximální indukovaný souvislý podgraf $G$. Vezměme
 libovolný $v \in V'$. Pak je ale $H = [v]_{ \sim }$, tedy třída ekvivalence $
 \sim $ obsahující $v$. Vskutku, z maximality $H$ platí $u \in H$, kdykoli $v
 \sim u$. Protože sjednocení všech $V_i$ je množina vrcholů $V$ a tyto $V_i$
 jsou po dvou disjunktní, existuje nutně přesně jedno $i \leq n$ takové, že $v
 \in V_i$. Pak $H = V_i$.
\end{proof}

Další zajímavou strukturální vlastností grafu je, že tvoří prostor. Než
specifikujeme, co tím míníme, odkročíme na chvíli a rozhovoříme se o tom, čemuže
vlastně matematik řekne \emph{prostor}.

Naši intuitivní představu prostoru splňují tzv. \emph{normované vektorové
prostory}, kde je definována velikost a směr (a tím i vzdálenost a úhel).
Velikosti i směry se dají sčítat a velikosti navíc násobit. Můžeme také hovořit
o jejich dimenzi. Obecně, normovaný vektorový prostor je určitě ten
nejjednodušší typ matematického prostoru, který aproximuje vesmír.

Existují však mnohem primitivnější prostory, které nemají zdaleka tolik
\uv{přirozených} vlastností. Mezi ně patří tzv. \emph{topologické} prostory,
které mají jen to nejzákladnější, co chceme po úplně každém typu prostoru --
tvar. O něco málo složitější jsou prostory \emph{metrické}, kde lze měřit
vzdálenost; nikoli však nutně velikost nebo směr. Jak si nyní povíme, grafy
přirozeně nabývají struktury metrických prostorů. To je snadné dokázat. Výrazně
těžší je dokázat (a dělat to nebudeme), že ve skutečnosti metrické prostory jsou
ty nejsložitější prostory, kterými grafy mohou být. Vektorové prostory to nikdy
nejsou, bez ohledu na zvolenou definici sčítání či násobení.

Pojďme tedy provést stručnou diskusi metrických prostorů. Snad už čtenářům
nezpůsobuje překvapení, že \uv{měření} vzdáleností v našem prostoru zajišťuje
vhodně zvolené zobrazení. Samotný prostor je v principu libovolná množina se
strukturou danou právě tímto zobrazením. Měření vzdáleností mezi párem jejích
prvků probíhá přiřazením nezáporné hodnoty (klidně i $\infty$) tomuto páru. Je
ještě nutné, aby měření splňovalo pár přirozených podmínek, které uvedeme v
následující definici a záhy osvětlíme.

\begin{definition}[Metrika]
 \label{def:metrika}
 Ať $X$ je množina. Zobrazení $\mu: X \times X \to [0,\infty]$ nazveme
 \emph{metrikou} na $X$, pokud
 \begin{enumerate}[label=(\alph*)]
  \item $\mu(x,x) = 0 \; \forall x \in X$,
  \item $\mu(x,y) = \mu(y,x) \; \forall x,y \in X$,
  \item (trojúhelníková nerovnost) $\mu(x,y) + \mu(y,z) \leq \mu(x,z) \;
   \forall x,y,z \in X$.
 \end{enumerate}
\end{definition}

\begin{definition}[Metrický prostor]
 \label{def:metricky-prostor}
 Dvojici $(X,\mu)$, kde $X$ je množina a $\mu$ je metrika na $X$ nazveme
 \emph{metrických prostorem}.
\end{definition}

\begin{remark}
 Přeložíme podmínky (a), (b) a (c) \hyperref[def:metrika]{definice metriky} do
 lidské řeči. O prvcích $X$ můžeme bez okolek hovořit jako o \uv{bodech} v
 prostoru.

 Podmínka (a) vyžaduje, aby žádný bod nebyl sám od sebe vzdálen. Bez ní bychom
 měli problém intuitivně definovat vzdálenost dvou různých bodů, neboť bych se
 mohl do počátečního bodu opakovaně vracet a zvyšovat tím vzdálenost od něj k
 bodům ostatním.

 Podmínka (b) říká, že $x$ je od $y$ stejně daleko jako $y$ od $x$. To je asi
 přirozená podmínka i bez bližšího vysvětlení.

 Konečně, podmínka (c) říká, že když jdu z $x$ do $z$, pak jakákoli
 \uv{zachá\-zka} do bodu $y$ nemůže délku cesty zkrátit. Tato podmínka opět zní
 velmi přirozeně a skutečně, bez ní by definice vzdálenosti opět nedávala
 intuitivní smysl. Jak by se mohlo stát, že by úsečka nebyla nejkratší spojnicí
 mezi dvěma body? Původ názvu \uv{trojúhelníková nerovnost} této podmínky
 osvětluje \myref{obrázek}{fig:trojuhelnikova-nerovnost}.
\end{remark}

\begin{figure}[h]
 \centering
 \begin{tikzpicture}
  \node[vertex,minimum size=6pt] (x) at (0,0) {};
  \node[vertex,minimum size=6pt] (z) at (3,2) {};
  \node[vertex,minimum size=6pt] (y) at (2,0.5) {};

  \node[below left=-1mm and -1mm of x] {$x$};
  \node[below right=-1mm and -1mm of y] {$y$};
  \node[right=0mm of z] {$z$};
  
  \draw[thick,myblue] (x) -- (z);
  \draw[thick,myred] (x) -- (y);
  \draw[thick,myred] (y) -- (z);
 \end{tikzpicture}

 \caption{Trojúhelníková nerovnost}
 \label{fig:trojuhelnikova-nerovnost}
\end{figure}

My ale přeci umíme měřit vzdálenosti v grafu! Pro dva vrcholy $u,v \in V$ jsme
si \hyperref[def:vzdalenost-v-grafu]{definovali} vzdálenost $u$ od $v$ jako váhu
nejkratší cesty mezi $u$ a $v$. V případě, že $G$ je neohodnocený, předpokládáme
implicitně, že váha každé hrany je $1$, tedy váha cesta je v tomto případě
totožná s její \emph{délkou}, počtem jejích hran.

Ukážeme, že množina vrcholů $V$ grafu $G = (V,E)$ spolu se zobrazením
\[
 d_G:V \times V \to [0,\infty],
\]
které každým dvěma vrcholům přiřadí jejich vzdálenost, je metrický prostor. To
plyne okamžitě z následujícího lemmatu.

\begin{lemma}
 \label{lem:vzdalenost-je-metrika}
 Ať $G = (V,E)$ je graf a $d_G(u,v)$ značí vzdálenost, tj. \emph{délku}
 nejkratší cesty, mezi $u$ a $v$ pro každé dva $u,v \in V$. Pak je $d_G$ metrika
 na $V$.
\end{lemma}
\begin{proof}
 Pro důkaz potřebujeme ověřit, že podmínky z \hyperref[def:metrika]{definice
 metriky} platí pro $d_G$.

 Podmínky (a) a (b) platí triviálně. Cesta z $v$ do $v$ obsahuje přesně jenom
 samotný vrchol $v$, tudíž nemá žádné hrany a její délka je $0$. To znamená, že
 $d_G(v,v) = 0$ pro každý $v \in V$. Dále, jest-li $e_1e_2\cdots e_n$ cesta z
 $u$ do $v$, kde $e_i \in E$, pak $e_ne_{n-1}\cdots e_1$ je cesta z $v$ do $u$
 zřejmě rovněž délky $n$. To dokazuje vztah $d_G(u,v) = d_G(v,u)$.

 Pokračujme trojúhelníkovou nerovností (c). Ať $u = u_1u_2\cdots u_{n+1} = v$ je
 cesta mezi $u$ a $v$ délky $n \in \N$ a $v = v_1v_2\cdots v_{m+1} = w$ cesta
 mezi $v$ a $w$ délky $m \in \N$. Podle důkazu
 \myref{lemmatu}{lem:cesta-ekvivalence} existují $j,k \in \N$ taková, že $u_k =
 v_j$ a $u_1u_2\cdots u_kv_{j+1}v_{j+2}\cdots v_m$ je cesta mezi $u$ a $w$. To
 ovšem znamená, že délka \textbf{nejkratší} cesty mezi $u$ a $w$ má nejvýš tolik
 hran, kolik cesta $u_1u_2\cdots u_kv_{j+1}\cdots v_{m+1}$, která jich má přesně
 $(k - 1) + (m - j)$. Protože $k - 1 \leq n$ a $m - j \leq m$, získáváme
 nerovnost
 \[
  d_G(u,w) \leq (k - 1) + (m - j) \leq n + m = d_G(u,v) + d_G(v,w),
 \]
 čímž je důkaz dokončen.
\end{proof}

Podsekci uzavřeme pár cvičeními.

\begin{exercise}[těžké]
 Kolik nejvíce hran může mít graf s $n$ a $k$ komponentami souvislosti?
\end{exercise}

\begin{exercise}
 Ať $V$ je \textbf{konečná} množina a $d:V \times V \to \{0,1,2,\ldots\}$ je
 metrika na $V$. Dokažte, že pak existuje graf $G = (V,E)$ takový, že $d_G(u,v)
 = d(u,v)$ pro všechny $u,v \in V$.
\end{exercise}

\begin{exercise}
 Navrhněte efektivní algoritmus, který pro zadaný graf $G = (V,E)$ rozhodne, zda
 je souvislý, a pokud není, najde jeho rozklad na komponenty souvislosti.
\end{exercise}
