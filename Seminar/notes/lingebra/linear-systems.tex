\chapter{Linear Systems}
\label{chap:linear-systems}

Linear systems are by definition sets of linear equations, that is, of equations
which relate present variables in a \emph{linear} way. It is important to
understand what this means. Spelled out, an expression on either side of any of
the equations is formed \emph{solely} by
\begin{enumerate}
 \item multiplying the variables by a given number (\textbf{not another
  variable}),
 \item adding these multiples together.
\end{enumerate}
Any such combination where variables are only allowed to be multiplied by a
constant and added is called a \emph{linear combination}. This term is extremely
important and ubiquitous throughout the text; hence, it warrants an isolated
definition. 

\begin{definition}{Linear combination}{linear-combination}
 Let $x_1,\ldots,x_n$ with $n \in \N$ be variables. Their \emph{linear
 combination} is any expression of the form
 \[
  a_1x_1 + a_2x_2 + \cdots + a_n x_n,
 \]
 where $a_1,\ldots,a_n$ are numbers.
\end{definition}

\begin{remark}{}{linear-combination}
 In the \hyperref[def:linear-combination]{definition above}, we have
 deliberately not specified what type of \emph{numbers} we mean. In the future,
 we shall work extensively with real and complex numbers as well as elements of
 other fields, which dear readers might not have even recognised as `numbers'
 thus far. The only important concept in this regard is the clear distinction
 between a \emph{number} (later \emph{scalar}) and a \emph{variable} (later
 \emph{vector}).
\end{remark}

\begin{example}{}{linear-combination}
 Consider the variables $x,y$ and $z$. The expression
 \[
  3x + 2y - 0.5z
 \]
 \textbf{is} their linear combination whereas
 \[
  5x + 3y - yz + 7z^2
 \]
 \textbf{is not}.
\end{example}

To reiterate, a \emph{linear system} is any set of equations featuring only
linear combinations of variables; these equations are consequently called
\emph{linear} as well. A \emph{solution} of a linear system is the set of all
possible substitutions of numbers (in place of variables) which make the
equations true.

It is clear that every linear equation can be rearranged to
\[
 a_1 x_1 + \cdots + a_n x_n = c
\]
for some variables $x_1,\ldots,x_n$ and numbers $a_1,\ldots,a_n,c$ by simple
subtraction. This is how we shall define it, for simplicity.

\begin{definition}{Linear equation}{linear-equation}
 Any equation of the form
 \begin{equation}
  \label{eq:linear-equation}
  a_1x_1 + a_2x_2 + \cdots + a_n x_n = c,
 \end{equation}
 where $x_1,\ldots,x_n$ are variables and $a_1,\ldots,a_n,c$ are numbers, is
 called \emph{linear}. A \emph{solution} of a linear equation is an $n$-tuple
 $(b_1,\ldots,b_n)$ of numbers such that under the substitutions $x_i \coloneqq
 b_i$, for $i \in \{1,\ldots,n\}$, the equation~\eqref{eq:linear-equation} is
 satisfied.
\end{definition}

\begin{example}{}{linear-equation}
 The equation
 \[
  3x_1 - 2x_2 + 4x_3 + x_4 = 5
 \]
 is \hyperref[def:linear-equation]{linear} in variables $x_1,x_2,x_3$ and $x_4$.
 On the contrary,
 \[
  3x_1x_2 - 4x_3^2 = 10
 \]
 is \textbf{not} linear.
\end{example}

\begin{definition}{Linear system}{linear-system}
 Any set of linear equations in the given variables $x_1,\ldots,x_n$ is called a
 \emph{linear system}. A \emph{solution} of a linear system is an $n$-tuple
 $(b_1,\ldots,b_n)$ which solves every linear equation in the set.
\end{definition}

\begin{example}{}{linear-system}
 The set of equations
 \[
  \begin{array}{rcrcrcr}
   3x_1 & - & x_2 & + & 2x_3 &= &1\\
   x_1 & & & - & x_3 &= &-1 \\
   2x_1 & - & 3x_2 & + & 3x_3 & = & 0
  \end{array}
 \]
 is a \hyperref[def:linear-system]{linear system} whose solution is the triple
 $(0,1,1)$.
\end{example}

%TODO reference
We proceed to discuss two trivial examples, which readers might have discussed
in high school, naturally leading to linear systems. More sophisticated examples
are presented in the applications section.

\begin{example}{Static equations}{static-equations}
 Suppose we have three objects -- one with a mass of $2$ and the other two with
 masses unknown. Experimentation produces these two balances.
 \begin{figure}[H]
  \centering
  \begin{subfigure}[b]{.45\textwidth}
   \centering
   \begin{tikzpicture}
    \node[isosceles triangle, draw, fill=black!30, anchor=left corner, shape
     border rotate=90, minimum height=5mm, minimum width=1cm, isosceles
     triangle stretches] (base) at (0,0) {};
    \coordinate[left=3 of base.north] (left);
    \coordinate[right=3 of base.north] (right);
    \draw (left) -- (right);

    \node[circle,draw,left=0.75cm of base.north,minimum height=6mm,inner
     sep=0,yshift=3mm] (x) {$x$};
    \node[circle,draw,left=2cm of base.north,minimum height=4mm,inner
     sep=0,yshift=2mm] (y) {$y$};
    \node[circle,draw,right=2.5cm of base.north,minimum height=5mm,inner
     sep=0,yshift=2.5mm] (two) {$2$};

    \coordinate[above=2cm of base.north] (above);
    \draw[dashed] (base.north) -- (above);
    \draw[dashed] (x.north) -- ($(above) - (1.05,0)$);
    \draw[dashed] (y.north) -- ($(above) - (2.2,0)$);
    \draw[dashed] (two.north) -- ($(above) + (2.75,0)$);

    \draw[<->,thick] ($(x.north) + (0,0.5)$) to
     node[midway,circle,fill=white,inner sep=1pt] {$15$} ($(x.north) +
     (1.05,0.5)$);
    \draw[<->,thick] ($(y.north) + (0,1.25)$) to
     node[midway,circle,fill=white,inner sep=1pt] {$40$} ($(y.north) +
     (2.2,1.25)$);
    \draw[<->,thick] ($(two.north) + (0,1.15)$) to
     node[midway,circle,fill=white,inner sep=1pt] {$50$} ($(two.north) +
     (-2.75,1.15)$);
   \end{tikzpicture}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}[b]{.45\textwidth}
   \centering
   \begin{tikzpicture}
    \node[isosceles triangle, draw, fill=black!30, anchor=left corner, shape
     border rotate=90, minimum height=5mm, minimum width=1cm, isosceles
     triangle stretches] (base) at (0,0) {};
    \coordinate[left=3 of base.north] (left);
    \coordinate[right=3 of base.north] (right);
    \draw (left) -- (right);

    \node[circle,draw,left=1.25cm of base.north,minimum height=6mm,inner
     sep=0,yshift=3mm] (x) {$x$};
    \node[circle,draw,right=2.5cm of base.north,minimum height=4mm,inner
     sep=0,yshift=2mm] (y) {$y$};
    \node[circle,draw,right=1.25cm of base.north,minimum height=5mm,inner
     sep=0,yshift=2.5mm] (two) {$2$};

    \coordinate[above=2cm of base.north] (above);
    \draw[dashed] (base.north) -- (above);
    \draw[dashed] (x.north) -- ($(above) - (1.55,0)$);
    \draw[dashed] (y.north) -- ($(above) + (2.7,0)$);
    \draw[dashed] (two.north) -- ($(above) + (1.5,0)$);

    \draw[<->,thick] ($(x.north) + (0,1.05)$) to
     node[midway,circle,fill=white,inner sep=1pt] {$25$} ($(x.north) +
     (1.55,1.05)$);
    \draw[<->,thick] ($(y.north) + (0,1.25)$) to
     node[midway,circle,fill=white,inner sep=1pt] {$50$} ($(y.north) +
     (-2.7,1.25)$);
    \draw[<->,thick] ($(two.north) + (0,0.6)$) to
     node[midway,circle,fill=white,inner sep=1pt] {$25$} ($(two.north) +
     (-1.5,0.6)$);
   \end{tikzpicture}
  \end{subfigure}
 \end{figure}

 For the weights to be in balance, the sums of \emph{moments} on both sides of
 the scales must be identical one to another. A \emph{moment} of an object is
 its distance from the centre of the scales times its mass. This condition
 yields a system of two linear equations
 \[
  \begin{array}{ccccccc}
   15x & + & 40y & = & 50 \cdot 2, & &\\
       &   & 25x & = & 25 \cdot 2 & + & 50y.
  \end{array}
 \]
 Or, after rearrangement (to stay true to \hyperref[def:linear-equation]{our
 definition of linear equation}),
 \[
  \begin{array}{ccccc}
   15x & + & 40y & = & 50 \cdot 2,\\
   25x & - & 50y & = & 25 \cdot 2.
  \end{array}
 \]
\end{example}

\begin{example}{Chemical reactions}{chemical-reactions}
 Toluene, $\mathtt{C_7 H_8}$, mixes (under right conditions) with nitric acid,
 $\mathtt{HNO_3}$, to produce trinitrotoluene (widely known as TNT),
 $\mathtt{C_7H_5O_6N_3}$, along with dihydrogen monoxide, $\mathtt{H_2O}$. If we
 want this chemical reaction to occur successfully, we must (among other things)
 ascertain we mix the constituents in the right proportion. In pseudo-chemical
 notation, the reaction to take place can be written as
 \[
  x \cdot \mathtt{C_7H_8} + y \cdot \mathtt{HNO_3} \longrightarrow z \cdot
  \mathtt{C_7H_5O_6N_3} + w \cdot \mathtt{H_2O}.
 \]
 Comparing the number of atoms of each element before the reaction and
 afterwards (which must remain identical owing to the conservation of energy)
 yields the system
 \[
  \begin{array}{cccccccc}
   \mathtt{H}: & 8x & + & 1y & = & 5z & + & 2w,\\
   \mathtt{C}: & 7x &   &    & = & 7z,&   &\\
   \mathtt{N}: &    &   & 1y & = & 3z,&   &\\
   \mathtt{O}: &    &   & 3y & = & 6z & + & 1w.
  \end{array}
 \]
\end{example}

In the next section, we devise an algorithm to solve any system of linear
equations.

\input{linear-systems/gauss-jordan}
\input{linear-systems/visualization}
\input{linear-systems/describing-solutions}
% \input{linear-systems/applications}
